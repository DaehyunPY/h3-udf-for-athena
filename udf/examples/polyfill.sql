-- get all h3 that covers Toulouse, Nantes, Lille, Paris, Nice 
USING EXTERNAL FUNCTION polyfill(polygonWKT VARCHAR, res INT)
RETURNS ARRAY(BIGINT)
LAMBDA 'arn:aws:lambda:<region>:<account>:function:<functionname>'
SELECT polyfill('POLYGON ((43.604652 1.444209, 47.218371 -1.553621, 50.62925 3.05726, 48.864716 2.349014, 43.6961 7.27178, 43.604652 1.444209))', 2)
-- [586466857871998975, 586467957383626751, 586469056895254527, 586470156406882303, 586475653965021183, 586476203720835071, 586477303232462847, 586477852988276735, 586478402744090623, 587026509290536959, 587034205871931391, 587035855139373055, 587036954651000831, 587043551720767487, 586023754686005247, 585897860604624895, 586454213488279551, 586456412511535103, 586461360313860095]


-- Polyfill and compact
USING EXTERNAL FUNCTION compact(h3array ARRAY(BIGINT))
RETURNS ARRAY(BIGINT)
LAMBDA 'arn:aws:lambda:<region>:<account>:function:<functionname>' 
SELECT compact(polyfillh3s) FROM (
USING EXTERNAL FUNCTION polyfill(polygonWKT VARCHAR, res INT)
RETURNS ARRAY(BIGINT)
LAMBDA 'arn:aws:lambda:<region>:<account>:function:<functionname>'
SELECT polyfill('POLYGON ((43.604652 1.444209, 47.218371 -1.553621, 50.62925 3.05726, 48.864716 2.349014, 43.6961 7.27178, 43.604652 1.444209))', 4) AS polyfillh3s)


